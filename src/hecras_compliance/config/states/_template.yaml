# =============================================================================
# State/Jurisdiction Compliance Rules — Template
# =============================================================================
#
# Copy this file to create rules for a new state or jurisdiction.
#
# GETTING STARTED:
#   1. Copy this file and rename it to your state (e.g. "florida.yaml")
#   2. Fill in the state/state_abbreviation fields
#   3. List any federal rules this file overrides in "supersedes"
#   4. Add your rules under the "rules:" list
#   5. Run the test suite to validate your YAML:  pytest tests/
#
# NAMING CONVENTION:
#   File name:  lowercase state name, no spaces (e.g. "new_york.yaml")
#   Rule IDs:   {STATE_ABBREV}-{CATEGORY}-{NUMBER}
#               e.g. "FL-FW-001", "NY-EVENT-001", "CA-MANN-001"
#
# HOW STATE RULES INTERACT WITH FEDERAL RULES:
#   State rules run IN ADDITION to the federal FEMA rules in
#   fema_rules.yaml.  If a state rule is stricter than a federal rule
#   (e.g. zero-rise floodway vs. 1-foot surcharge), list the federal
#   rule ID in "supersedes" so the engine knows to skip the less-strict
#   federal check.
#
# =============================================================================


# ---- State Identification ---------------------------------------------------
# These fields identify which jurisdiction these rules apply to.

state: ""                # Full state name (e.g. "Florida")
state_abbreviation: ""   # Two-letter abbreviation (e.g. "FL")


# ---- Superseded Federal Rules -----------------------------------------------
# List the IDs of any federal rules (from fema_rules.yaml) that this state
# file REPLACES with a stricter or different requirement.
#
# Example: Texas enforces a zero-rise floodway, which supersedes the
# federal 1.0-foot surcharge limit (FEMA-FW-001).
#
# Leave this empty if all state rules are additive (i.e. they don't
# conflict with any federal rules).

supersedes: []
  # - FEMA-FW-001     # Uncomment if your state overrides the federal
                       # floodway surcharge with a stricter standard


# ---- Rules ------------------------------------------------------------------
# Each rule is a YAML mapping with the following fields.
# All fields are required unless noted otherwise.
#
# FIELD REFERENCE:
#
#   id: (string, required)
#     Unique identifier.  Use the pattern {STATE}-{CATEGORY}-{NNN}.
#     Categories used so far:
#       MANN   – Manning's n roughness checks
#       COEF   – Expansion/contraction coefficients
#       FW     – Floodway / surcharge rules
#       EVENT  – Required flood-frequency events
#       BRG    – Bridge and structure checks
#       BC     – Boundary condition checks
#       FB     – Freeboard requirements
#     You may define new categories as needed.
#
#   name: (string, required)
#     Short human-readable label (< 60 characters).  Shown in reports
#     and CLI output.
#
#   description: (string, required)
#     Full explanation of what is being checked and WHY it matters.
#     This text appears in the compliance report.  Write it for the
#     audience: a hydraulic engineer or FEMA reviewer, not a developer.
#     Use the YAML ">" block scalar for multi-line text.
#
#   severity: (string, required)
#     One of:
#       error   – Hard failure.  Model cannot be submitted until fixed.
#       warning – Potential problem.  Reviewer should verify manually.
#       info    – Informational flag.  No action required but noted in
#                 the report for completeness.
#
#   citation: (string, required)
#     The exact regulatory or guidance reference.  Include the document
#     title, section number, and any subsection/paragraph identifiers.
#     Examples:
#       "44 CFR 65.12 – Revision of flood insurance rate maps"
#       "Texas Administrative Code, Title 31, Part 16, Chapter 299"
#       "FEMA G&S Appendix C: Guidance for Riverine Flooding"
#
#   check_type: (string, required)
#     Determines how the rule is evaluated.  One of:
#
#       range  – Value must fall within [min, max] inclusive.
#                Requires parameters: min, max
#
#       exact  – Value must equal a specific target.
#                Requires parameters: value
#
#       exists – The field must be present and non-null.
#                No parameters required (use empty map: {})
#
#       custom – Evaluation is handled by a named Python function.
#                Requires parameters: handler (function name)
#                May include additional parameters consumed by the handler.
#
#   parameters: (mapping, required)
#     Key-value pairs that configure the check.  Contents depend on
#     check_type — see examples below.
#
#   applies_to: (string, required)
#     Dot-path into the parsed HEC-RAS data model.  The engine uses
#     this to locate the value(s) to check.
#
#     Available paths:
#
#       GEOMETRY (from parse_geometry → GeometryFile):
#         geometry.cross_sections[].manning_n_channel
#         geometry.cross_sections[].manning_n_left
#         geometry.cross_sections[].manning_n_right
#         geometry.cross_sections[].manning_n_overbank   (checks both L+R)
#         geometry.cross_sections[].expansion
#         geometry.cross_sections[].contraction
#         geometry.cross_sections[].bank_stations
#         geometry.cross_sections[].ineffective_areas
#         geometry.bridges[].min_low_chord
#         geometry.bridges[].opening_width
#
#       PLAN (from parse_plan → PlanFile):
#         plan.plan_type
#         plan.flow_regime
#         plan.encroachment.enabled
#         plan.encroachment.method
#         plan.encroachment.target_surcharge
#         plan.computation.friction_slope_method
#
#       FLOW (from parse_flow → FlowFile):
#         flow.profile_names
#         flow.flow_change_locations
#         flow.steady_boundaries
#         flow.unsteady_boundaries
#         flow.boundaries              (all boundary types)
#
#       PROJECT (from parse_project → ProjectFile):
#         project.units
#         project.geom_files
#         project.plan_files
#         project.steady_files
#         project.unsteady_files

rules: []

  # ---------------------------------------------------------------------------
  # EXAMPLE: Range Check
  # ---------------------------------------------------------------------------
  # Uncomment and modify this block to add a range-based rule.
  #
  # - id: XX-MANN-001
  #   name: Channel Manning's n range
  #   description: >
  #     Describe what is being checked and why.  Reference the regulatory
  #     basis for the acceptable range.
  #   severity: error
  #   citation: "State Code Title X, Section Y.Z"
  #   check_type: range
  #   parameters:
  #     min: 0.020
  #     max: 0.150
  #   applies_to: geometry.cross_sections[].manning_n_channel

  # ---------------------------------------------------------------------------
  # EXAMPLE: Custom Check (Required Flood Events)
  # ---------------------------------------------------------------------------
  # Uncomment and modify this block to require specific flood profiles.
  #
  # - id: XX-EVENT-001
  #   name: 1-percent annual chance flood required
  #   description: >
  #     Describe which flood event is required and cite the regulation.
  #   severity: error
  #   citation: "State Code Title X, Section Y.Z"
  #   check_type: custom
  #   parameters:
  #     handler: check_profile_exists
  #     accepted_names:
  #       - "100yr"
  #       - "100-yr"
  #       - "1pct"
  #       - "1% Annual Chance"
  #       - "Base Flood"
  #   applies_to: flow.profile_names

  # ---------------------------------------------------------------------------
  # EXAMPLE: Exact Value Check
  # ---------------------------------------------------------------------------
  # Uncomment and modify this block to require an exact value.
  #
  # - id: XX-FW-001
  #   name: Zero-rise floodway required
  #   description: >
  #     Describe the zero-rise or specific surcharge requirement.
  #   severity: error
  #   citation: "State Code Title X, Section Y.Z"
  #   check_type: exact
  #   parameters:
  #     value: 0.0
  #   applies_to: plan.encroachment.target_surcharge

  # ---------------------------------------------------------------------------
  # EXAMPLE: Exists Check
  # ---------------------------------------------------------------------------
  # Uncomment and modify this block to require a field to be present.
  #
  # - id: XX-BRG-001
  #   name: Bridge low chord must be defined
  #   description: >
  #     Describe why the field must exist and what regulation requires it.
  #   severity: warning
  #   citation: "State Code Title X, Section Y.Z"
  #   check_type: exists
  #   parameters: {}
  #   applies_to: geometry.bridges[].min_low_chord

  # ---------------------------------------------------------------------------
  # EXAMPLE: Manual Review Flag
  # ---------------------------------------------------------------------------
  # Uncomment and modify this block to flag something for manual review.
  #
  # - id: XX-FB-001
  #   name: Freeboard requirement (manual review)
  #   description: >
  #     Describe what the reviewer needs to check and why it cannot be
  #     automated (e.g. value varies by jurisdiction).
  #   severity: info
  #   citation: "State Code Title X, Section Y.Z; local ordinances"
  #   check_type: custom
  #   parameters:
  #     handler: flag_for_manual_review
  #     review_note: >
  #       Instructions for the reviewer about what to verify.
  #   applies_to: plan.encroachment.target_surcharge
